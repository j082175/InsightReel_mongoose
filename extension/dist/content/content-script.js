(()=>{const t={SERVER_URL:"http://localhost:3000",NODE_ENV:"production",GOOGLE_API_KEY:null,isDevelopment:!1},e={INSTAGRAM:"INSTAGRAM",TIKTOK:"TIKTOK",YOUTUBE:"YOUTUBE"};class n{static detectPlatform(){const t=window.location.hostname;return t.includes("instagram.com")?"INSTAGRAM":t.includes("tiktok.com")?"TIKTOK":t.includes("youtube.com")||t.includes("youtu.be")?"YOUTUBE":null}static log(t,e,n=null){const o=`[InsightReel ${(new Date).toISOString()}]`;switch(t){case"info":console.log(`${o} â„¹ï¸ ${e}`,n||"");break;case"warn":console.warn(`${o} âš ï¸ ${e}`,n||"");break;case"error":console.error(`${o} âŒ ${e}`,n||"");break;case"success":console.log(`${o} âœ… ${e}`,n||"");break;default:console.log(`${o} ${e}`,n||"")}}}const o={mediaData:{},mediaIdMap:{},fbIdMap:{},init(){this.setupNetworkInterception(),this.extractFromPageData(),n.log("success","ğŸ”¥ Instagram Media Tracker ì´ˆê¸°í™” ì™„ë£Œ")},setupNetworkInterception(){const t=this,e=XMLHttpRequest.prototype.open,n=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(t,n,...o){return this._url=n,e.apply(this,arguments)},XMLHttpRequest.prototype.send=function(e){return this.addEventListener("load",function(){if(this.status>=200&&this.status<300)try{if(this.responseURL.includes("/graphql/query")){const e=JSON.parse(this.responseText);t.processGraphQLResponse(e)}else if(this.responseURL.includes("/api/v1/media/")&&this.responseURL.includes("/info/")){const e=JSON.parse(this.responseText);t.processMediaInfoResponse(e)}else if(this.responseURL.includes("/api/v1/feed/")){const e=JSON.parse(this.responseText);t.processFeedResponse(e)}}catch(t){}}),n.apply(this,arguments)}},processGraphQLResponse(t){this.extractMediaFromAnyLevel(t)},processMediaInfoResponse(t){t.items&&t.items.forEach(t=>this.storeMediaInfo(t))},processFeedResponse(t){t.items&&t.items.forEach(t=>{t.media?this.storeMediaInfo(t.media):this.storeMediaInfo(t)})},storeMediaInfo(t){var e,o,i,s,r,a,l;if(null==t||!t.code||null==t||!t.like_count)return;const c=t.code;if(this.mediaData[c])return void this.updateExistingMedia(this.mediaData[c],t);const d={code:c,created_at:(null==t||null===(e=t.caption)||void 0===e?void 0:e.created_at)||(null==t?void 0:t.taken_at),like_count:t.like_count,comment_count:t.comment_count,play_count:(null==t?void 0:t.ig_play_count)||(null==t?void 0:t.play_count)||(null==t?void 0:t.view_count),username:(null==t||null===(o=t.caption)||void 0===o||null===(o=o.user)||void 0===o?void 0:o.username)||(null==t||null===(i=t.owner)||void 0===i?void 0:i.username)||(null==t||null===(s=t.user)||void 0===s?void 0:s.username),video_url:null==t||null===(r=t.video_versions)||void 0===r||null===(r=r[0])||void 0===r?void 0:r.url,img_origin:null==t||null===(a=t.image_versions2)||void 0===a||null===(a=a.candidates)||void 0===a||null===(a=a[0])||void 0===a?void 0:a.url};null!=t&&t.carousel_media&&(d.carousel_media=t.carousel_media.map(t=>{var e,n;return[null==t||null===(e=t.video_versions)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.url,null==t||null===(n=t.image_versions2)||void 0===n||null===(n=n.candidates)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.url]}).flat().filter(t=>t).join("\n")),this.mediaData[c]=d,t.id&&(this.mediaIdMap[t.id]=c),t.pk&&(this.fbIdMap[t.pk]=c),t.video_id&&(this.fbIdMap[t.video_id]=c),t.fb_video_id&&(this.fbIdMap[t.fb_video_id]=c),n.log("info","ğŸ“± ë¯¸ë””ì–´ ì •ë³´ ì €ì¥ë¨",{shortcode:c,url:(null===(l=d.video_url)||void 0===l?void 0:l.substring(0,50))+"...",hasCarousel:!!d.carousel_media})},updateExistingMedia(t,e){var n,o,i;!t.video_url&&null!=e&&null!==(n=e.video_versions)&&void 0!==n&&null!==(n=n[0])&&void 0!==n&&n.url&&(t.video_url=e.video_versions[0].url),!t.created_at&&(null!=e&&null!==(o=e.caption)&&void 0!==o&&o.created_at||null!=e&&e.taken_at)&&(t.created_at=(null===(i=e.caption)||void 0===i?void 0:i.created_at)||e.taken_at)},extractMediaFromAnyLevel(t,e=0){if(!(e>15)&&t&&"object"==typeof t){t.code&&t.like_count&&this.storeMediaInfo(t),t.data&&this.processDataSection(t.data);for(const n in t)t.hasOwnProperty(n)&&t[n]&&"object"==typeof t[n]&&this.extractMediaFromAnyLevel(t[n],e+1)}},processDataSection(t){var e,n,o;null!==(e=t.xdt_api__v1__feed__timeline__connection)&&void 0!==e&&e.edges&&t.xdt_api__v1__feed__timeline__connection.edges.forEach(t=>{var e;null!==(e=t.node)&&void 0!==e&&e.media&&this.storeMediaInfo(t.node.media)}),null!==(n=t.xdt_api__v1__clips__home__connection_v2)&&void 0!==n&&n.edges&&t.xdt_api__v1__clips__home__connection_v2.edges.forEach(t=>{var e;null!==(e=t.node)&&void 0!==e&&e.media?this.storeMediaInfo(t.node.media):t.node&&this.storeMediaInfo(t.node)}),null!==(o=t.xdt_api__v1__media__shortcode__web_info)&&void 0!==o&&o.items&&t.xdt_api__v1__media__shortcode__web_info.items.forEach(t=>{this.storeMediaInfo(t)})},extractFromPageData(){const t=document.querySelectorAll('script[type="application/json"]');for(const e of t)try{const t=JSON.parse(e.textContent);this.extractMediaFromAnyLevel(t)}catch(t){}},getMediaInfoForCurrentVideo(){const t=window.location.href.match(/\/p\/([A-Za-z0-9_-]+)|\/reel\/([A-Za-z0-9_-]+)|\/reels\/([A-Za-z0-9_-]+)/),e=t?t[1]||t[2]||t[3]:null;if(e&&this.mediaData[e])return n.log("info","ğŸ¯ URLì—ì„œ ë¯¸ë””ì–´ ë°œê²¬:",e),this.mediaData[e];const o=Object.values(this.mediaData).filter(t=>t.video_url).sort((t,e)=>(e.created_at||0)-(t.created_at||0))[0];return o?(n.log("info","ğŸ¯ ìµœê·¼ ë¹„ë””ì˜¤ ë¯¸ë””ì–´ ì‚¬ìš©:",o.code),o):null}};class i{constructor(){this.isAnalyzing=!1,this.channelButton=null,this.init()}init(){n.log("info","ğŸ¥ YouTube ì±„ë„ ë¶„ì„ê¸° ì´ˆê¸°í™”"),this.checkForChannelPage(),this.observeURLChanges()}observeURLChanges(){let t=location.href;new MutationObserver(()=>{location.href!==t&&(t=location.href,setTimeout(()=>this.checkForChannelPage(),1e3))}).observe(document,{subtree:!0,childList:!0})}isChannelPage(){const t=window.location.href;return t.includes("/channel/")||t.includes("/@")||t.includes("/c/")||t.includes("/user/")}checkForChannelPage(){this.isChannelPage()?this.waitForChannelHeader():this.removeAnalyzeButton()}waitForChannelHeader(){let t=0;const e=()=>{t++;const o=document.querySelector("#channel-name, .ytd-channel-name, #text-container h1"),i=document.querySelector("#subscriber-count, .ytd-subscriber-count");o&&i?this.addAnalyzeButton():t<10?setTimeout(e,1e3):n.log("warn","âš ï¸ ì±„ë„ í—¤ë”ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ")};e()}addAnalyzeButton(){this.removeAnalyzeButton();const t=document.querySelector("#subscribe-button, .ytd-subscribe-button-renderer");if(!t)return void n.log("warn","âš ï¸ êµ¬ë… ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ì–´ ë²„íŠ¼ ìœ„ì¹˜ ê²°ì • ì‹¤íŒ¨");this.channelButton=document.createElement("button"),this.channelButton.textContent="ğŸ¤– ì±„ë„ ë¶„ì„",this.channelButton.className="youtube-channel-analysis-button",this.channelButton.style.cssText="\n            background: linear-gradient(45deg, #ff6b6b, #ee5a24) !important;\n            color: white !important;\n            border: none !important;\n            border-radius: 20px !important;\n            padding: 12px 20px !important;\n            font-size: 14px !important;\n            font-weight: bold !important;\n            cursor: pointer !important;\n            margin: 10px !important;\n            box-shadow: 0 4px 12px rgba(0,0,0,0.3) !important;\n        ",this.channelButton.addEventListener("click",()=>{this.analyzeChannel()});const e=t.closest("#subscribe-button")||t.parentElement;e&&(e.appendChild(this.channelButton),n.log("success","âœ… YouTube ì±„ë„ ë¶„ì„ ë²„íŠ¼ ì¶”ê°€ë¨"))}removeAnalyzeButton(){const t=document.querySelector(".youtube-channel-analysis-button");t&&t.remove(),this.channelButton=null}async analyzeChannel(){if(this.isAnalyzing)n.log("warn","ì´ë¯¸ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤");else{this.isAnalyzing=!0,this.updateButtonState(!0);try{const e=this.extractChannelData();if(!e)return void n.log("error","ì±„ë„ ë°ì´í„°ë¥¼ ì¶”ì¶œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤");n.log("info","ğŸ¯ ì±„ë„ ë¶„ì„ ì‹œì‘",e);const o=await fetch(`${t.SERVER_URL}/api/process-channel`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:"YOUTUBE",type:"channel",data:e,url:window.location.href,timestamp:(new Date).toISOString()})});if(o.ok){const t=await o.json();n.log("success","âœ… ì±„ë„ ë¶„ì„ ì™„ë£Œ",t)}else n.log("error","âŒ ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜",o.status)}catch(t){n.log("error","âŒ ì±„ë„ ë¶„ì„ ì‹¤íŒ¨",t.message)}finally{this.isAnalyzing=!1,this.updateButtonState(!1)}}}extractChannelData(){var t,e,n,o,i;const s=null===(t=document.querySelector("#channel-name .ytd-channel-name, #text-container h1"))||void 0===t||null===(t=t.textContent)||void 0===t?void 0:t.trim(),r=null===(e=document.querySelector("#subscriber-count, .ytd-subscriber-count"))||void 0===e||null===(e=e.textContent)||void 0===e?void 0:e.trim(),a=null===(n=document.querySelector("#description-content, .ytd-channel-about-metadata-renderer"))||void 0===n||null===(n=n.textContent)||void 0===n?void 0:n.trim(),l=window.location.href;return{name:s,id:(null===(o=l.match(/\/channel\/([^\/\?]+)/))||void 0===o?void 0:o[1])||(null===(i=l.match(/\/@([^\/\?]+)/))||void 0===i?void 0:i[1]),subscribers:r,description:a,url:l}}updateButtonState(t){this.channelButton&&(this.channelButton.textContent=t?"ğŸ”„ ë¶„ì„ì¤‘...":"ğŸ¤– ì±„ë„ ë¶„ì„",this.channelButton.disabled=t,this.channelButton.style.cursor=t?"not-allowed":"pointer")}}const s={processedElements:new Set,scanInterval:null,init(){n.log("info","ğŸ¨ Instagram UI System ì‹œì‘"),this.startScanning(),this.scanForMedia()},startScanning(){this.scanInterval=setInterval(()=>{this.scanForMedia()},3e3),this.scanForMedia()},scanForMedia(){let t=0,e="";const o=['article[role="presentation"]',"article",'div[role="presentation"]','[data-testid="post-item"]','div[style*="flex-direction"]'];for(const i of o){const o=document.querySelectorAll(i);let s=0;if(o.forEach(e=>{if(this.processedElements.has(e))return;const n=e.querySelector("video"),o=e.querySelector('img[src*="scontent"], img[src*="cdninstagram"], img[src*="instagram"], img[alt]'),i="ARTICLE"===e.tagName;(n||o||i)&&(this.addAnalysisButton(e),this.processedElements.add(e),t++,s++)}),s>0&&(e=i,n.log("success",`âœ… ${s}ê°œ ìƒˆ í¬ìŠ¤íŠ¸ ë°œê²¬ (${i})`)),t>0)break}const i=Date.now();(!this.lastDebugTime||i-this.lastDebugTime>5e3)&&(0===t&&(n.log("info","ğŸ” Instagram í¬ìŠ¤íŠ¸ ìŠ¤ìº” ì¤‘..."),this.debugDOMStructure()),this.lastDebugTime=i)},debugDOMStructure(){const t=document.querySelectorAll("article"),e=document.querySelectorAll("div[role]"),o=document.querySelectorAll("video");n.log("info","ğŸ“Š DOM êµ¬ì¡° ë¶„ì„:",{articles:t.length,divsWithRole:e.length,videos:o.length,url:window.location.href})},addAnalysisButton(t){if(t.querySelector(".instagram-analysis-button"))return;const e=document.createElement("button");e.textContent="ğŸ¤– ë¶„ì„",e.className="instagram-analysis-button",e.style.cssText="\n            background: linear-gradient(45deg, #8e44ad, #3498db) !important;\n            color: white !important;\n            border: none !important;\n            border-radius: 20px !important;\n            padding: 8px 16px !important;\n            font-size: 12px !important;\n            font-weight: bold !important;\n            cursor: pointer !important;\n            margin: 5px !important;\n            z-index: 9999 !important;\n            position: absolute !important;\n            top: 10px !important;\n            right: 10px !important;\n            box-shadow: 0 2px 8px rgba(0,0,0,0.3) !important;\n        ",e.addEventListener("click",()=>{this.analyzeInstagramMedia()});let o=!1;const i=['svg[aria-label*="ì €ì¥"], svg[aria-label*="Save"]','svg[aria-label*="Bookmark"]','[data-testid="save-button"]','[role="button"][aria-label*="Save"]'];for(const s of i){const i=t.querySelectorAll(s);if(i.length>0){const t=i[0].closest("button");if(t&&t.parentElement){t.parentElement.appendChild(e),o=!0,n.log("success",`âœ… ì €ì¥ ë²„íŠ¼ ê·¼ì²˜ì— ë¶„ì„ ë²„íŠ¼ ì¶”ê°€ë¨ (${s})`);break}}}return o||(e.style.position="fixed !important",e.style.top="80px !important",e.style.right="20px !important",e.style.zIndex="10000 !important",document.body.appendChild(e),o=!0,n.log("success","âœ… ê³ ì • ìœ„ì¹˜ì— ë¶„ì„ ë²„íŠ¼ ì¶”ê°€ë¨ (ë ˆì´ì•„ì›ƒ ë³´ì¡´)")),o},async analyzeInstagramMedia(){n.log("info","ğŸ¯ Instagram ë¯¸ë””ì–´ ë¶„ì„ ì‹œì‘");try{const e=o.getMediaInfoForCurrentVideo();if(!e)return void n.log("warn","í˜„ì¬ ë¯¸ë””ì–´ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤");const i=await fetch(`${t.SERVER_URL}/api/process-video`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:"INSTAGRAM",type:"video",data:e,url:window.location.href,timestamp:(new Date).toISOString()})});if(i.ok){const t=await i.json();n.log("success","âœ… Instagram ë¯¸ë””ì–´ ë¶„ì„ ì™„ë£Œ",t)}else n.log("error","âŒ ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜",i.status)}catch(t){n.log("error","âŒ Instagram ë¯¸ë””ì–´ ë¶„ì„ ì‹¤íŒ¨",t.message)}},cleanup(){this.scanInterval&&clearInterval(this.scanInterval),this.processedElements.clear()}},r={init(){this.addYouTubeButtons(),this.setupUrlChangeListener()},setupUrlChangeListener(){let t=window.location.href;console.log("ğŸ”„ YouTube ë¶„ì„ ë²„íŠ¼ URL ë³€ê²½ ê°ì§€ ì‹œì‘");const e=()=>{const e=window.location.href;t!==e&&(console.log("ğŸ”„ YouTube ë¶„ì„ ë²„íŠ¼ URL ë³€ê²½ ê°ì§€:",t,"â†’",e),t=e,this.updateButtonsVisibility())};window.addEventListener("yt-navigate-finish",()=>{setTimeout(()=>this.updateButtonsVisibility(),500)}),new MutationObserver(e).observe(document,{subtree:!0,childList:!0}),setInterval(e,1e3)},updateButtonsVisibility(){this.isValidAnalysisPage()?(console.log("âœ… ë¶„ì„ ê°€ëŠ¥í•œ í˜ì´ì§€ë¡œ ì´ë™ - ì ì ˆí•œ ë¶„ì„ ë²„íŠ¼ ìƒì„±"),this.addYouTubeButtons()):(console.log("ğŸš« ë¶„ì„ ë¶ˆê°€ëŠ¥í•œ í˜ì´ì§€ë¡œ ì´ë™ - ëª¨ë“  ë¶„ì„ ë²„íŠ¼ ì œê±°"),this.removeAllAnalysisButtons())},addYouTubeButtons(){if(!this.isValidAnalysisPage())return console.log("ğŸš« ë¶„ì„ ë¶ˆê°€ëŠ¥í•œ í˜ì´ì§€ - ë²„íŠ¼ ìƒì„±í•˜ì§€ ì•ŠìŒ"),void this.removeAllAnalysisButtons();const t="/watch"===window.location.pathname,e=window.location.pathname.startsWith("/shorts/");console.log("âœ… ë¶„ì„ ê°€ëŠ¥í•œ í˜ì´ì§€ - ë²„íŠ¼ ìƒì„± ì§„í–‰"),t?(this.addYouTubeVideoAnalysisButton(),this.removeShortsButton()):e&&(this.addYouTubeShortsAnalysisButton(),this.removeVideoButton())},isValidAnalysisPage(){const t=window.location.href;if(t.includes("/watch")||t.includes("/shorts/"))return!0;const e=["https://www.youtube.com/","https://www.youtube.com","https://www.youtube.com/feed/subscriptions","https://www.youtube.com/feed/trending","https://www.youtube.com/feed/explore"];for(const n of e)if(t===n||t.startsWith(n+"?"))return!1;return!1},removeAllAnalysisButtons(){this.removeVideoButton(),this.removeShortsButton()},removeVideoButton(){const t=document.querySelector(".youtube-analysis-button");t&&(t.remove(),console.log("ğŸ—‘ï¸ ì˜ìƒ ë¶„ì„ ë²„íŠ¼ ì œê±°ë¨"))},removeShortsButton(){const t=document.querySelector(".youtube-shorts-analysis-button");t&&(t.remove(),console.log("ğŸ—‘ï¸ ì‡¼ì¸  ë¶„ì„ ë²„íŠ¼ ì œê±°ë¨"))},findVideoButtonContainer(){console.log("ğŸ” ì˜ìƒ ë¶„ì„ ë²„íŠ¼ ì»¨í…Œì´ë„ˆ ê²€ìƒ‰ ì‹œì‘");const t=["#top-level-buttons-computed","#actions #top-level-buttons",".ytd-menu-renderer #top-level-buttons","#menu-container #top-level-buttons"];for(const e of t){const t=document.querySelector(e);if(t&&this.isValidButtonContainer(t))return console.log(`âœ… ê¸°ë³¸ ì…€ë ‰í„°ë¡œ ì»¨í…Œì´ë„ˆ ë°œê²¬: ${e}`),t}const e=["#actions .ytd-menu-renderer",".ytd-video-primary-info-renderer #menu","#primary-inner #menu",".ytd-watch-flexy #menu","#actions .yt-spec-touch-feedback-shape",'.ytd-video-primary-info-renderer [role="toolbar"]'];for(const t of e){const e=document.querySelector(t);if(e&&this.isValidButtonContainer(e))return console.log(`âœ… ëŒ€ì²´ ì…€ë ‰í„°ë¡œ ì»¨í…Œì´ë„ˆ ë°œê²¬: ${t}`),e}const n=["#actions","#primary-inner",".ytd-video-primary-info-renderer"];for(const t of n){const e=document.querySelector(t);if(e&&this.isValidButtonContainer(e))return console.log(`âš ï¸ ë„“ì€ ë²”ìœ„ ì…€ë ‰í„°ë¡œ ì»¨í…Œì´ë„ˆ ë°œê²¬: ${t}`),e}return console.log("âŒ ì˜ìƒ ë¶„ì„ ë²„íŠ¼ ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì§€ ëª»í•¨"),null},findShortsButtonContainer(){console.log("ğŸ” ì‡¼ì¸  ë¶„ì„ ë²„íŠ¼ ì»¨í…Œì´ë„ˆ ê²€ìƒ‰ ì‹œì‘");const t=["#actions","ytd-reel-video-renderer #actions",".ytd-reel-player-header-renderer #actions","#shorts-container #actions"];for(const e of t){const t=document.querySelector(e);if(t&&this.isValidButtonContainer(t))return console.log(`âœ… ê¸°ë³¸ ì‡¼ì¸  ì…€ë ‰í„°ë¡œ ì»¨í…Œì´ë„ˆ ë°œê²¬: ${e}`),t}const e=["ytd-reel-video-renderer .ytd-menu-renderer",".reel-video-in-sequence #actions",".ytd-shorts #actions","#shorts-player #actions",'[role="toolbar"]'];for(const t of e){const e=document.querySelector(t);if(e&&this.isValidButtonContainer(e))return console.log(`âœ… ëŒ€ì²´ ì‡¼ì¸  ì…€ë ‰í„°ë¡œ ì»¨í…Œì´ë„ˆ ë°œê²¬: ${t}`),e}const n=["ytd-reel-video-renderer","#shorts-container",".ytd-reel-player-header-renderer"];for(const t of n){const e=document.querySelector(t);if(e&&this.isValidButtonContainer(e))return console.log(`âš ï¸ ë„“ì€ ë²”ìœ„ ì‡¼ì¸  ì…€ë ‰í„°ë¡œ ì»¨í…Œì´ë„ˆ ë°œê²¬: ${t}`),e}return console.log("âŒ ì‡¼ì¸  ë¶„ì„ ë²„íŠ¼ ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì§€ ëª»í•¨"),null},isValidButtonContainer(t){if(!t)return!1;if(!t.offsetParent)return console.log("âŒ ì»¨í…Œì´ë„ˆê°€ ë³´ì´ì§€ ì•ŠìŒ"),!1;const e=t.getBoundingClientRect();return e.width<10||e.height<10?(console.log("âŒ ì»¨í…Œì´ë„ˆê°€ ë„ˆë¬´ ì‘ìŒ:",e),!1):e.top<0||e.left<0||e.top>window.innerHeight?(console.log("âŒ ì»¨í…Œì´ë„ˆê°€ í™”ë©´ ë°–ì— ìˆìŒ:",e),!1):(console.log("âœ… ìœ íš¨í•œ ì»¨í…Œì´ë„ˆ í™•ì¸ë¨:",e),!0)},addYouTubeVideoAnalysisButton(){if(document.querySelector(".youtube-analysis-button"))return;const t=this.findVideoButtonContainer();if(t){const e=document.createElement("button");e.textContent="ğŸ¬ ì˜ìƒ ë¶„ì„",e.className="youtube-analysis-button",e.style.cssText="\n                background: #ff0000 !important;\n                color: white !important;\n                border: none !important;\n                border-radius: 18px !important;\n                padding: 10px 16px !important;\n                font-size: 14px !important;\n                font-weight: 500 !important;\n                cursor: pointer !important;\n                margin-left: 8px !important;\n                height: 36px !important;\n            ",e.addEventListener("click",()=>{this.analyzeYouTubeVideo()}),t.appendChild(e),n.log("success","âœ… YouTube ì˜ìƒ ë¶„ì„ ë²„íŠ¼ ì¶”ê°€ë¨")}},addYouTubeShortsAnalysisButton(){if(document.querySelector(".youtube-shorts-analysis-button"))return;const t=this.findShortsButtonContainer();if(t){const e=document.createElement("button");e.textContent="ğŸ“±",e.title="Shorts ë¶„ì„",e.className="youtube-shorts-analysis-button",e.style.cssText="\n                background: rgba(0, 0, 0, 0.8) !important;\n                color: white !important;\n                border: 1px solid rgba(255, 255, 255, 0.3) !important;\n                border-radius: 24px !important;\n                width: 48px !important;\n                height: 48px !important;\n                font-size: 16px !important;\n                cursor: pointer !important;\n                margin: 8px 0 !important;\n                display: flex !important;\n                align-items: center !important;\n                justify-content: center !important;\n            ",e.addEventListener("click",()=>{this.analyzeYouTubeVideo(!0)}),t.appendChild(e),n.log("success","âœ… YouTube Shorts ë¶„ì„ ë²„íŠ¼ ì¶”ê°€ë¨")}},async analyzeYouTubeVideo(e=!1){n.log("info",`ğŸ¯ YouTube ${e?"Shorts":"ì˜ìƒ"} ë¶„ì„ ì‹œì‘`);try{const o=this.extractVideoData(),i=await fetch(`${t.SERVER_URL}/api/process-video`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:"YOUTUBE",type:e?"shorts":"video",data:o,url:window.location.href,timestamp:(new Date).toISOString()})});if(i.ok){const t=await i.json();n.log("success","âœ… YouTube ì˜ìƒ ë¶„ì„ ì™„ë£Œ",t)}else n.log("error","âŒ ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜",i.status)}catch(t){n.log("error","âŒ YouTube ì˜ìƒ ë¶„ì„ ì‹¤íŒ¨",t.message)}},extractVideoData(){var t,e;return{videoId:this.extractYouTubeId(window.location.href),title:null===(t=document.querySelector("h1.ytd-video-primary-info-renderer, #title h1"))||void 0===t||null===(t=t.textContent)||void 0===t?void 0:t.trim(),channelName:null===(e=document.querySelector("#channel-name a, .ytd-channel-name a"))||void 0===e||null===(e=e.textContent)||void 0===e?void 0:e.trim(),url:window.location.href}},extractYouTubeId(t){const e=t.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/shorts\/)([^&\n?#]+)/);return e?e[1]:null}};class a{constructor(){this.platform=n.detectPlatform(),this.init()}init(){n.log("info","ğŸš€ InsightReel Complete Content Script ì‹œì‘",{platform:this.platform,url:window.location.href,environment:t.NODE_ENV}),this.platform?(this.setupMessageListeners(),this.initializePlatformFeatures(),window.addEventListener("beforeunload",()=>{this.cleanup()}),n.log("success",`âœ… ${this.platform} í”Œë«í¼ ê¸°ëŠ¥ ì´ˆê¸°í™” ì™„ë£Œ`)):n.log("warn","ì§€ì›ë˜ì§€ ì•ŠëŠ” í”Œë«í¼",window.location.hostname)}initializePlatformFeatures(){switch(this.platform){case e.INSTAGRAM:window.INSTAGRAM_MEDIA_TRACKER=o,o.init(),window.INSTAGRAM_UI_SYSTEM=s,setTimeout(()=>s.init(),1e3);break;case e.YOUTUBE:window.youtubeChannelAnalyzer=new i,r.init();break;case e.TIKTOK:this.initializeTikTok()}}initializeTikTok(){setInterval(()=>{this.addTikTokAnalysisButtons()},2e3)}addTikTokAnalysisButtons(){document.querySelectorAll('div[data-e2e="recommend-list-item"]').forEach(t=>{if(t.querySelector(".tiktok-analysis-button"))return;const e=document.createElement("button");e.textContent="ğŸµ ë¶„ì„",e.className="tiktok-analysis-button",e.style.cssText="\n                background: #fe2c55 !important;\n                color: white !important;\n                border: none !important;\n                border-radius: 16px !important;\n                padding: 8px 12px !important;\n                font-size: 12px !important;\n                cursor: pointer !important;\n                position: absolute !important;\n                top: 10px !important;\n                right: 10px !important;\n                z-index: 9999 !important;\n            ",e.addEventListener("click",()=>{this.analyzeTikTokVideo()}),t.style.position="relative",t.appendChild(e)})}async analyzeTikTokVideo(){n.log("info","ğŸ¯ TikTok ì˜ìƒ ë¶„ì„ ì‹œì‘");try{const e=await fetch(`${t.SERVER_URL}/api/process-video`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:"TIKTOK",type:"video",url:window.location.href,timestamp:(new Date).toISOString()})});if(e.ok){const t=await e.json();n.log("success","âœ… TikTok ì˜ìƒ ë¶„ì„ ì™„ë£Œ",t)}else n.log("error","âŒ ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜",e.status)}catch(t){n.log("error","âŒ TikTok ì˜ìƒ ë¶„ì„ ì‹¤íŒ¨",t.message)}}setupMessageListeners(){chrome.runtime.onMessage.addListener((t,e,n)=>(this.handleMessage(t,e,n),!0))}async handleMessage(e,o,i){try{switch(e.action){case"ping":i({success:!0,message:"Complete Content Script ì‘ë‹µ"});break;case"getStatus":i({success:!0,data:{platform:this.platform,serverUrl:t.SERVER_URL,environment:t.NODE_ENV,features:{instagramMediaTracker:!!window.INSTAGRAM_MEDIA_TRACKER,youtubeChannelAnalyzer:!!window.youtubeChannelAnalyzer,instagramUISystem:!!window.INSTAGRAM_UI_SYSTEM},version:"complete-restored"}});break;default:i({error:"ì•Œ ìˆ˜ ì—†ëŠ” ì•¡ì…˜ì…ë‹ˆë‹¤."})}}catch(t){n.log("error","ë©”ì‹œì§€ ì²˜ë¦¬ ì‹¤íŒ¨",t.message),i({error:t.message})}}cleanup(){window.INSTAGRAM_UI_SYSTEM&&s.cleanup(),n.log("info","Complete Content Script ì •ë¦¬ ì™„ë£Œ")}}try{n.log("info","ğŸš€ InsightReel Complete Content Script ì´ˆê¸°í™” ì‹œì‘");const o=new a;window.INSIGHTREEL={contentScript:o,utils:n,platforms:e,environment:t,version:"complete-restored"},t.isDevelopment&&(window.ContentScript=o,window.Utils=n,window.PLATFORMS=e,window.environment=t,n.log("info","ğŸ› ï¸ ê°œë°œ ëª¨ë“œ: ë””ë²„ê¹… ê°ì²´ë“¤ì´ windowì— ë“±ë¡ë¨")),n.log("success","âœ… InsightReel Complete Content Script ì´ˆê¸°í™” ì™„ë£Œ")}catch(t){console.error("âŒ InsightReel Complete Content Script ì‹¤í–‰ ì˜¤ë¥˜:",t),console.error("ì˜¤ë¥˜ ìœ„ì¹˜:",t.stack),window.INSIGHTREEL_ERROR={error:t.message,stack:t.stack,timestamp:(new Date).toISOString(),version:"complete-restored"}}})();